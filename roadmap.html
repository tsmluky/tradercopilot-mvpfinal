<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>TraderCopilot · Roadmap Depurado + Instrucciones</title>
<style>
  :root{
    --bg:#0b0c0f; --fg:#e8eaed; --muted:#a6adbb;
    --accent:#7c5cff; --accent-2:#00d8ff; --card:#12141a; --border:#1f2330;
    --ok:#18c964; --warn:#ffb020; --danger:#ff5470;
  }
  *{box-sizing:border-box}
  html,body{margin:0;padding:0;background:var(--bg);color:var(--fg);font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
  a{color:var(--accent-2);text-decoration:none}
  .container{max-width:1100px;margin:48px auto;padding:0 24px}
  .hero{background:linear-gradient(135deg,rgba(124,92,255,.2),rgba(0,216,255,.12));border:1px solid var(--border);padding:32px;border-radius:20px}
  .title{font-size:42px;line-height:1.1;margin:0 0 8px}
  .subtitle{color:var(--muted);margin:0}
  .grid{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin:28px 0}
  .card{background:var(--card);border:1px solid var(--border);border-radius:18px;padding:22px}
  .kpi{display:flex;gap:12px;align-items:center;margin:6px 0}
  .kpi .dot{width:10px;height:10px;border-radius:50%}
  .ok{background:var(--ok)} .warn{background:var(--warn)} .danger{background:var(--danger)}
  h2{margin:26px 0 10px;font-size:26px}
  h3{margin:20px 0 8px;font-size:20px}
  .mono{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}
  .badge{display:inline-block;border:1px solid var(--border);background:#0f1118;padding:4px 10px;border-radius:999px;color:var(--muted);font-size:12px;margin-right:8px}
  .stage{border-left:4px solid var(--accent);padding-left:16px;margin:20px 0}
  .list{margin:8px 0 4px 0;padding-left:18px}
  .muted{color:var(--muted)}
  .code{background:#0f1118;border:1px solid var(--border);padding:14px;border-radius:12px;overflow:auto}
  .two-col{display:grid;grid-template-columns:1fr 1fr;gap:16px}
  .footer{margin:48px 0 24px;color:var(--muted);font-size:13px;text-align:center}
  @media (max-width:900px){.grid,.two-col{grid-template-columns:1fr} .title{font-size:34px}}
</style>
</head>
<body>
  <div class="container">
    <section class="hero">
      <h1 class="title">TraderCopilot · Roadmap Depurado + Instrucciones</h1>
      <p class="subtitle">Versión: 2025-11-16 · Estado: listo para ejecución · North Star: usuarios de pago activos, retención 30d, hit-rate LITE ≥ <b>55%</b> con RR ≥ 1.5</p>
      <div class="grid">
        <div class="card">
          <h3>Principios</h3>
          <ul class="list">
            <li>Monetización primero · Incremental · Sin rehacer backend</li>
            <li>Métricas y pruebas reproducibles</li>
            <li>Entregables paste-ready (archivos completos y scripts)</li>
          </ul>
        </div>
        <div class="card">
          <h3>Ámbito inicial</h3>
          <ul class="list">
            <li>Tokens: <b>ETH, BTC, SOL, XAU</b></li>
            <li>Modos: <b>LITE, PRO, ADVISOR</b></li>
            <li>Canal premium Telegram + APK estable</li>
          </ul>
        </div>
      </div>
    </section>

    <section class="stage">
      <span class="badge">ETAPA 0 · v0.6.x</span>
      <h2>Fundación Técnica & Mental (no se cambia)</h2>
      <ul class="list">
        <li>Backend FastAPI: <span class="mono">/analyze/{lite,pro,advisor}</span>, <span class="mono">/logs/{mode}/{token}</span>, <span class="mono">/notify/telegram</span></li>
        <li>RAG básico por token: <span class="mono">brain/{token}/{insights.md, news.txt, onchain.txt, sentiment.txt}</span></li>
        <li>Prompt PRO estricto: <span class="mono">#ANALYSIS_START..END</span> con <span class="mono">#CTXT #TA #PLAN #INSIGHT #PARAMS</span></li>
        <li>Logs CSV por modo/token + evaluación automática LITE (2h)</li>
        <li>Frontend base: Chat, Logs, Settings; MarkdownCard / SignalCard; selector de token</li>
      </ul>
      <div class="two-col">
        <div class="card">
          <h3>DoD</h3>
          <ul class="list">
            <li><span class="mono">/health</span> ok</li>
            <li>Scripts Postman/PowerShell funcionando</li>
            <li>CSVs persisten y se leen en la app</li>
          </ul>
        </div>
        <div class="card">
          <h3>KPIs</h3>
          <div class="kpi"><span class="dot ok"></span>Latencia local &lt; 2.0s</div>
          <div class="kpi"><span class="dot ok"></span>Flujo TELEGRAM probado</div>
        </div>
      </div>
    </section>

    <section class="stage">
      <span class="badge">ETAPA 1 · v0.7</span>
      <h2>MVP Monetizable</h2>
      <ul class="list">
        <li>LITE: generación + evaluación automática visible en Logs</li>
        <li>PRO: Markdown limpio con acciones Copiar/Compartir</li>
        <li>Advisor: recomendaciones operativas básicas</li>
        <li>Canal premium, onboarding manual, cohorte 20 testers</li>
      </ul>
      <div class="two-col">
        <div class="card">
          <h3>DoD</h3>
          <ul class="list">
            <li>APK sin autoscroll/crashes</li>
            <li>Canal premium activo</li>
            <li>≥ 5 usuarios de pago</li>
          </ul>
        </div>
        <div class="card">
          <h3>KPIs Semana 1</h3>
          <div class="kpi"><span class="dot ok"></span>≥ 30 señales LITE evaluadas</div>
          <div class="kpi"><span class="dot ok"></span>≥ 5 usuarios premium o sponsors</div>
        </div>
      </div>
    </section>

    <section class="stage">
      <span class="badge">ETAPA 2 · v1.0</span>
      <h2>Producto Premium</h2>
      <ul class="list">
        <li>Indicadores locales: RSI, EMA(21/50), MACD, ATR, Bollinger</li>
        <li>Feeds: Kraken/Binance (opcional Allora)</li>
        <li>RAG intermedio con refresco diario de news/sentiment</li>
        <li>Dashboard premium y salas por token</li>
      </ul>
      <div class="card">
        <h3>DoD</h3>
        <ul class="list">
          <li>Latencia promedio &lt; 2.0s</li>
          <li>&gt;= 10 usuarios de pago; churn &lt; 15%</li>
        </ul>
      </div>
    </section>

    <section class="stage">
      <span class="badge">ETAPA 3 · v1.5</span>
      <h2>TraderCopilot Pro</h2>
      <ul class="list">
        <li>Integración <span class="mono">trading_lab</span> (backtesting, walk-forward básico)</li>
        <li>Asesor de posición abierta con planes A/B</li>
        <li>Detección de setups: EMA21 bounce, RSI reversal, MACD cross + volumen</li>
      </ul>
    </section>

    <section class="stage">
      <span class="badge">ETAPA 4 · v2.0</span>
      <h2>Dream Edition</h2>
      <ul class="list">
        <li>Workspace web, gráficos avanzados, API pública</li>
        <li>Marketplace de estrategias y copia de trades</li>
      </ul>
    </section>

    <section>
      <h2>Instrucciones LLM oficiales</h2>
      <div class="code mono">
<pre>Eres el "Copiloto de Producto" de TraderCopilot. Objetivo: maximizar valor de negocio con incrementos pequeños sin rehacer el backend.
Reglas: (1) Monetización primero. (2) Nada que requiera rediseño del backend antes del MVP. (3) El MVP debe ser pagable, no perfecto. (4) Incremental por capas. (5) Señala sesgos y riesgos (modo sparring) sin suavizar.
Entregables paste-ready: archivos completos, scripts PowerShell, JSON Schemas, contratos API, formatos Telegram, pruebas reproducibles. Si se pide una función, entrega el archivo entero listo para pegar.
Estándares: rutas /analyze/{{mode}}, logs backend/logs/{{MODE}}/{{token}}.csv, evaluados LITE en backend/logs/EVALUATED/{{token}}.evaluated.csv, RAG en brain/{{token}}/. Tokens: eth, btc, sol, xau.
Salida: define KPIs si impacta usuarios/dinero. Código con tipos, manejo de errores y ejemplos. Si hay ambigüedad, decide y documenta el supuesto.</pre>
      </div>
    </section>

    <section>
      <h2>Contratos API (v0.7)</h2>
      <div class="two-col">
        <div class="card">
          <h3>POST /analyze/lite</h3>
          <div class="code mono">{ "token":"eth", "timeframe":"30m" }</div>
        </div>
        <div class="card">
          <h3>POST /analyze/pro</h3>
          <div class="code mono">{ "token":"eth","timeframe":"30m","context":{"rag":true} }</div>
        </div>
      </div>
      <div class="two-col">
        <div class="card">
          <h3>POST /analyze/advisor</h3>
          <div class="code mono">{ "token":"eth","direction":"long","entry":3675.5,"tp":3720,"sl":3625,"size_quote":500 }</div>
        </div>
        <div class="card">
          <h3>GET /logs/{mode}/{token}</h3>
          <p class="muted">mode ∈ {LITE, PRO, ADVISOR, EVALUATED}; token ∈ {eth, btc, sol, xau}</p>
        </div>
      </div>
    </section>

    <section>
      <h2>Formatos Telegram</h2>
      <div class="two-col">
        <div class="card">
          <h3>LITE (envío)</h3>
          <div class="code mono">[LITE] ETH 30m — long
Entry: 3675.5 | TP: 3720 | SL: 3625 | Conf: 0.68
Razón: Pullback EMA21 con RSI&gt;50 y vol ↑</div>
        </div>
        <div class="card">
          <h3>LITE (resultado)</h3>
          <div class="code mono">[LITE·RESULT] ETH 30m → hit-tp (+1.2%) en 1h58m
Notas: cerca de resistencia previa</div>
        </div>
      </div>
    </section>

    <section>
      <h2>Árbol, .env y Scripts</h2>
      <div class="code mono">
backend/
  main.py
  indicators/
  logs/{LITE,PRO,ADVISOR,EVALUATED}/
  tools/{start_dev.ps1, update_and_eval.ps1}
frontend/
  screens/{Chat,Logs,Settings}
  components/{MessageBubble,MarkdownCard,SignalCard}
brain/eth|btc|sol|xau/{insights.md,news.txt,onchain.txt,sentiment.txt}
      </div>
      <h3>.env mínimo</h3>
      <div class="code mono">DEEPSEEK_API_KEY=...
TRADERCOPILOT_BOT_TOKEN=...
TELEGRAM_CHAT_ID=130261699
DB_PATH=backend/data/signalbot.db
CACHE_TTL_SEC=120
RATE_LIMIT_PER_MIN=30</div>
    </section>

    <section class="card">
      <h2>Playbook de 7 días</h2>
      <ol class="list">
        <li>Día 1-2: cerrar Etapa 0, canal premium, 10 señales demo</li>
        <li>Día 3-4: APK estable, 10 testers, medir latencia</li>
        <li>Día 5-7: abrir a 20, resumen semanal con hit-rate</li>
      </ol>
    </section>

    <p class="footer">© 2025 TraderCopilot — Documento vivo. Actualizar con cada release.</p>
  </div>
</body>
</html>
